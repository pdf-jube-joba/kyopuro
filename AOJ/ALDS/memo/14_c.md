# pattern search
## 内容
\(H \times W\) に並べられた文字がある。 \(R \times C\) 文字のパターンをその中から見つけたい

## メモ
Rolling hash を使う
\(m \times n\) 行列 \((a_{i,j})_ {0 \leq i < m, 0 \leq j < n}\) に対して、 \(b \in \mathbb{Z}\) での hash を \(h(a_ {i,j}) = \sum_{i,j} a_ {i,j} * b^{m * n - n(j-1) - (i-1)}\) として定める。

これは、 \(a_{i,j}\) を横書きとして順番に並べるときに、 \(b^{*}\) の次数が順々に下がっていくように定めている。
i.e. \(a_{0,0} * b^{t} + a_{0,1} * b^{t-1} + ... + a_{0,n-1} * b^{t-(n-1)} + a_{1,0} * b^{t^(n-1) - 1} + a_{1,1} * b^{t^{n-1} - 2} + ... + a_{m-1, n-1}^{0}\) となるように \(b^{*}\) の次数を決めた。

hash をかける部分を横に動かそうと、縦に動かそうと、 r や c 倍のコストがかかる？
縦部分を先に計算して入れておけば、計算が楽にできる？
\(A_{i,j} = (a_{i,j} ... a_{i+(r-1),j})^{\text{t}}\) なる縦部分の hash を \(H_{i,j} = \sum_{0 \leq k < r} a_{i+k,j} * b^{c * ((r-1) - k)}\) とする。

1. 初めに \(H_{0,0},...,H_{0,w-1}\) を計算する。
   1. 各 \(H_{i,0}\) の計算量は \(O(r)\) になる。
2. \((a_{i,j})_{0 \leq i < r, 0 \leq j < c}\) のハッシュを \(H _{0,0}\) から \(H _{0,c-1}\) を使って計算する。 このコストは　\(O(c)\) になる。
3.  各 \(0 \leq k < w-c\) に対して \((a_{i+k,j}) _{0 \leq i < r, 0 \leq j < c}\) のハッシュを \(k-1\) で得られたハッシュと \(H _{0, k}\) をもとに計算する。このコストは \(O(1)\) になる。
4.  各 \(0 \leq k < w\) に対して \(H_{1,k}\) を \(H_{0,k}\) をもとに計算する。このコストは \(O(1)\) になる。
5. 2. に戻り \(a_{1,*}\) でのハッシュを計算する

